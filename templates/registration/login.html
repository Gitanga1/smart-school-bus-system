{% extends 'base.html' %}

{% block title %}Login - Smart School Bus{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card mt-5">
            <div class="card-header bg-primary text-white">
                <h4 class="card-title mb-0">
                    <i class="fas fa-sign-in-alt"></i> Login to Smart School Bus
                </h4>
            </div>
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    
                    {% if form.errors %}
                    <div class="alert alert-danger">
                        Your username and password didn't match. Please try again.
                    </div>
                    {% endif %}
                    
                    <!-- Username Field -->
                    <div class="mb-3">
                        <label for="id_username" class="form-label">
                            <i class="fas fa-user"></i> Username
                        </label>
                        <input type="text" name="username" class="form-control" id="id_username" 
                               placeholder="Enter your username" required autocomplete="username">
                    </div>
                    
                    <!-- Password Field with Toggle -->
                    <div class="mb-3">
                        <label for="id_password" class="form-label">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <div class="input-group">
                            <input type="password" name="password" class="form-control" id="id_password" 
                                   placeholder="Enter your password" required autocomplete="current-password">
                            <button type="button" class="btn btn-outline-secondary" id="togglePassword">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <small class="form-text text-muted">
                            Click the eye icon to show/hide password
                        </small>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                </form>
                
                <div class="mt-3 text-center">
                    <p class="text-muted">Don't have an account? Contact your school administrator.</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for Password Toggle -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('id_password');
    const icon = togglePassword.querySelector('i');
    
    function togglePasswordVisibility() {
        // Toggle between password and text type
        const isPassword = passwordInput.type === 'password';
        passwordInput.type = isPassword ? 'text' : 'password';
        
        // Toggle eye icon
        if (isPassword) {
            // Show password - change to eye-slash
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
            togglePassword.setAttribute('aria-label', 'Hide password');
        } else {
            // Hide password - change to eye
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
            togglePassword.setAttribute('aria-label', 'Show password');
        }
    }
    
    // Click event for toggle button
    togglePassword.addEventListener('click', togglePasswordVisibility);
    
    // Keyboard accessibility
    togglePassword.addEventListener('keydown', function(event) {
        if (event.key === 'Enter' || event.key === ' ') {
            event.preventDefault();
            togglePasswordVisibility();
        }
    });
});
</script>

<style>
/* Optional: Improve the input group styling */
.input-group .btn {
    border-left: none;
}
.input-group .form-control {
    border-right: none;
}
.input-group .form-control:focus {
    border-right: none;
}
</style>
{% endblock %}